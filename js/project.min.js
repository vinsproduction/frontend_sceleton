var Models,PrototypeModel,UserModel,__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};PrototypeModel=function(){function a(){}return a.prototype.getApiPrefix=function(){return"api/"},a.prototype.get=function(a,b,c){return null==b&&(b={}),app.api.get(this.getApiPrefix()+a,b,function(b){return"error"===b.status&&console.error("[App > models] "+a+" | error: ",b.message),c?c(b):void 0})},a.prototype.post=function(a,b,c){return null==b&&(b={}),app.api.post(this.getApiPrefix()+a,b,function(b){return"error"===b.status&&console.error("[App > models] "+a+" | error: ",b.message),c?c(b):void 0})},a}(),UserModel=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.getDetails=function(a,b){return this.get("user/details",a,function(){return function(a){return b(a)}}(this))},b}(PrototypeModel),Models=function(){function a(){this.user=new UserModel}return a}();var IndexHash,IndexRenderView,IndexScroll,IndexView,PrototypeView,Views,allView,__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};PrototypeView=function(){function a(){this.varconstants={},this.init()}return a.prototype.render_debug=!0,a.prototype.setRenders=function(a){return this.template=a,_.each(this.template,function(a){return function(b,c){return a.templateSourse||(a.templateSourse={}),a.templateSourse[c]=$.trim(b.html()),a.render||(a.render={}),a.render[c]=function(b){return null==b&&(b={}),a.doRender(c,a.template[c],a.templateSourse[c],b)},a.preRender||(a.preRender={}),a.preRender[c]=function(b){return null==b&&(b={}),a.doPreRender(c,a.template[c],b)}}}(this))},a.prototype.doPreRender=function(a,b,c){var d,e,f,g,h,i,j;try{return e=c&&c.color?c.color:"inherit",d=c&&c.bg?c.bg:"none",h=c&&null!=c.text?c.text:"загрузка ...",j=c&&c.width?parseInt(c.width)+"px":"100%",g=c&&c.height?parseInt(c.height)+"px":"100%",i=c&&c.top?parseInt(c.top)+"px":0,this.render_debug&&console.log("[preRender "+a+"] loadtext:",h),b.html(null!=h?'<div class="render-preloader" style="width: '+j+"; height: "+g+"; background: "+d+'; position:relative; clear:both;">\n	<div style="top:'+i+"; text-align: center; position: relative; clear:both; color: "+e+';">\n		'+h+"\n	</div>\n</div>":'<div class="render-preloader" style="width: '+j+"; height: "+g+"; background: "+d+';">\n	<div class="inner" style="top:'+i+';">\n		<div class="clock"></div>\n		<div class="loader"></div>\n	</div>\n</div>')}catch(k){return f=k,console.error("[preRender] template undefined"),console.error(f)}},a.prototype.doRender=function(a,b,c,d){switch(null==d&&(d={method:"html"}),this.render_debug&&console.log("[Render "+a+"]","| @vars:",this.vars),d.method){case"append":return b.append(Mustache.to_html(c,this.vars));case"prepend":return b.prepend(Mustache.to_html(c,this.vars));default:return b.html(Mustache.to_html(c,this.vars))}},a.prototype.init=function(){},a.prototype.controller=function(a){this.opt=null!=a?a:{}},a.prototype.actions=function(){},a.prototype.doImage=function(a,b){var c;return null==b&&(b=""),a&&""!==a?(/http:\/\//.test(a)||(a=app.root+a),c='<img src="'+a+'" class="'+b+'" >'):void 0},a}(),allView=function(){function a(){this.sections=$("body > main > .sections"),this.section=this.sections.find("> section")}return a}(),IndexView=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.init=function(){},b.prototype.controller=function(a){return this.opt=null!=a?a:{},this.el=$("main.view-index"),app.onScroll(function(a){return console.log("--> onScroll",a)}),app.onResize(function(a){return console.log("--> onResize",a)}),$(window).resize(),app.onHash(function(a){return console.log("--> onHash",a)}),console.log("Hello! This is index controller")},b}(PrototypeView),IndexRenderView=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.init=function(){},b.prototype.controller=function(a){return this.opt=null!=a?a:{},this.el=$("main.view-index-render"),this.setRenders({text:this.el.find(".text")}),this.vars={},this.preRender.text({text:"Load..."}),app.models.user.getDetails({},function(a){return function(b){var c;return b.error?app.errors.popup(b.error):(c=_.clone(b),a.renderResponse(c))}}(this))},b.prototype.renderResponse=function(a){return _.extend(this.vars,this.varconstants),_.extend(this.vars,a),this.vars.avatar&&this.doImage(this.vars.avatar),this.render.text(),this.actions()},b.prototype.actions=function(){},b}(PrototypeView),IndexScroll=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.init=function(){},b.prototype.controller=function(a){var b;return this.opt=null!=a?a:{},this.el=$("main.view-index-scroll"),this.router=new indexScrollRouter,Backbone.history.start(),b=this,this.el.find("header nav#menu li a[data-page]").click(function(){return console.log("!"+$(this).attr("data-page")),b.router.navigate("!"+$(this).attr("data-page"),!0),!1}),app.onResize(function(){return function(a){return app.views.all.section.css({"min-height":a.windowHeight})}}(this)),$(window).trigger("resize")},b}(PrototypeView),IndexHash=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.init=function(){},b.prototype.controller=function(a){var b;return this.opt=null!=a?a:{},this.el=$("main.view-index-hash"),this.router=new indexHashRouter,Backbone.history.start(),b=this,this.el.find("header nav#menu li a[data-page]").click(function(){return b.router.navigate("!"+$(this).attr("data-page"),!0),!1})},b}(PrototypeView),Views=function(){function a(){}return a.prototype.controller=function(){return this.all=new allView,this.index=new IndexView,this.indexRender=new IndexRenderView,this.indexScroll=new IndexScroll,this.indexHash=new IndexHash},a}();var indexHashRouter,indexScrollRouter,__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};indexHashRouter=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.routes={"":"index","!":"index","!index":"index","!page":"page","!page/":"page","!page/:id":"page","!page/:id/":"page","!ooops":"ooops","!ooops/":"ooops","*path":"notFound"},b.prototype.initialize=function(){return this.bind("all",function(){})},b.prototype.before=function(a){return this.route=""===a?"empty":a,app.debugBox.state&&app.debugBox.log("route",this.route),console.debug("[App > router]","route:",this.route),this.hide()},b.prototype.after=function(){},b.prototype.hide=function(){return $("body > main > .sections > section").removeClass("current").hide()},b.prototype.show=function(a,b){var c;return null==b&&(b=""),c=$("section[data-page='"+a+"']"),this.hide(),c.addClass("current").show(),$("body").attr("data-page",a).attr("data-key",b)},b.prototype.scrollTop=function(a){return app.scroll(0,a)},b.prototype.notFound=function(a){var b;return b="not-found",this.scrollTop(),this.show(b),console.error("[App > router] route "+a+" not found"),app.debugBox.state?app.debugBox.log("route","not found"):void 0},b.prototype.ooops=function(){var a;return a="ooops",this.scrollTop(),this.show(a)},b.prototype.index=function(){var a;return a="index",this.scrollTop(),this.show(a)},b.prototype.page=function(){var a;return a="page",this.scrollTop(),this.show(a)},b}(Backbone.Router),indexScrollRouter=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.routes={"":"index","!":"index","!index":"index","!page":"page","!page/":"page","!page/:id":"page","!page/:id/":"page","*path":"notFound"},b.prototype.initialize=function(){return this.bind("all",function(){}),setTimeout(function(a){return function(){var b;return b=[],app.views.all.section.each(function(){return b.push({name:$(this).attr("data-page"),top:$(this).offset().top-60})}),b.reverse(),console.log("[App > indexScrollRouter > set sections]",b),app.onScroll(function(c){var d,e;return d=_.find(b,function(a){return c.top>a.top-10}),e=d?d.name:!1,e?(a.navigate("!"+e),a.show(e,!1)):void 0})}}(this),700)},b.prototype.before=function(a){return this.route=""===a?"empty":a,app.debugBox.state&&app.debugBox.log("route",this.route),console.debug("[App > router]","route:",this.route)},b.prototype.after=function(){},b.prototype.hide=function(){return $("body > main > .sections > section").removeClass("current")},b.prototype.show=function(a,b){var c;return null==b&&(b=!0),c=$("section[data-page='"+a+"']"),this.hide(),c.addClass("current"),$("body").attr("data-page",a),b?app.scroll(c.offset().top-60,!0):void 0},b.prototype.scrollTop=function(a){return app.scroll(0,a)},b.prototype.notFound=function(a){return console.error("[App > router] route "+a+" not found"),app.debugBox.state?app.debugBox.log("route","not found"):void 0},b.prototype.index=function(){var a;return a="index",this.show(a)},b.prototype.page=function(){var a;return a="page",this.show(a)},b}(Backbone.Router);var App,__indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};App=function(){function a(a){var b;null==a&&(a={}),this.options={name:"Frontend Skeleton",debugUri:"debug",boxUri:"box",localHost:["","localhost"],remoteHost:"http://vinsproduction.com",root:"",box:!1},_.extend(this.options,a),this.name=this.options.name,this.remoteHost=this.options.remoteHost,this.root=this.options.root,this.boxUri=this.options.boxUri,this.debugUri=this.options.debugUri,this.debugMode=/debug/.test(window.location.search),this.local=""===window.location.host||/localhost/.test(window.location.host),this.host=window.location.protocol+"//"+window.location.host,this.boxMode=new RegExp(this.boxUri).test(window.location.search)||this.options.box,this.boxParams=function(a){return function(){var b;return a.boxMode?(b=$$.urlParam(a.boxUri),b?b.split(","):[]):[]}}(this)(),this.debugMode=new RegExp(this.debugUri).test(window.location.search),this.debugParams=function(a){return function(){var b;return a.debugMode?(b=$$.urlParam(a.debugUri),b?b.split(","):[]):[]}}(this)(),this.local&&window.WebSocket&&(b=777,$$.includeJS("http://localhost:"+b+"/livereload.js"),console.debug("[App > Livereload] http://localhost:"+b+"/livereload.js")),this.libs(),this.listeners(),this.init()}return a.prototype.init=function(){return $(function(a){return function(){return a.boxMode&&a.debugBox.init(),"undefined"!=typeof Models&&null!==Models&&(a.models=new Models),"undefined"!=typeof Views&&null!==Views&&(a.views=new Views,a.views.controller()),"undefined"!=typeof Router&&null!==Router&&(a.router=new Router,Backbone.history.start()),a.social.init(),window.console.info("[App > onLoad]",a.name,"Options >",a.options," Debug >",a.debugMode?a.debugParams:!1," Box >",a.boxMode?a.boxParams:!1," Browser > "+$$.browser.name+" ver. "+$$.browser.version),$(window).trigger("AppOnLoad")}}(this))},a.prototype.listeners=function(){var a,b;return b=this,this.onLoad=function(a){return $(window).on("AppOnLoad",function(){return"undefined"!=typeof app&&null!==app&&a?a(app):void 0})},this.onScroll=function(a){return $(window).on("AppOnScroll",function(b,c){return a?a(c):void 0})},a=0,$(window).scroll(function(c){var d,e,f,g;return f=b.scroll(),f!==a?(e=f+$(window).height()>=$(document).height(),d=f>a?"down":"up",a=f,app.debugBox.state&&app.debugBox.log("scroll",""+d+" | top: "+f+"px | isBottom "+e),g={top:f,isBottom:e,action:d,e:c},$(window).trigger("AppOnScroll",[g])):void 0}),this.onResize=function(a){return $(window).on("AppOnResize",function(b,c){return a?a(c):void 0})},$(window).resize(function(){return function(){var a;return a=app.size(),app.debugBox.state&&(app.debugBox.log("sect","header: "+a.headerHeight+"px | sections: "+a.sectionsHeight+"px | footer: "+a.footerHeight+"px"),app.debugBox.log("res",""+a.windowWidth+"px x "+a.windowHeight+"px")),$(window).trigger("AppOnResize",[a])}}(this)),this.onLoad(function(){return $(window).resize()}),this.onHash=function(a){var b;return b=!1,$(window).on("AppOnHash",function(b,c){return a?a(c):void 0}),b?void 0:(a&&a(window.location.hash),b=!0)},$(window).on("hashchange",function(){return function(){return $(window).trigger("AppOnHash",[window.location.hash])}}(this)),$(window).trigger("hashchange")},a.prototype.scroll=function(a,b){var c,d,e,f;return f=(null!=b?b.time:void 0)||800,d=(null!=b?b.easing:void 0)||"easeOutCubic",c=!1,null!=a&&_.isString(a)?(e=$(a),e[0]&&_.isElement(e[0])?b?$("html,body").stop().animate({scrollTop:e.offset().top},f,d,function(){return!c&&(c=!0,b.done)?b.done():void 0}):$("html,body").scrollTop(e.offset().top):void 0):null!=a&&a[0]&&_.isElement(a[0])?b?$("html,body").stop().animate({scrollTop:a.offset().top},f,d,function(){return!c&&(c=!0,b.done)?b.done():void 0}):$("html,body").scrollTop(a.offset().top):null!=a?b?$("html,body").stop().animate({scrollTop:a},f,d,function(){return!c&&(c=!0,b.done)?b.done():void 0}):$("html,body").scrollTop(a):$(window).scrollTop()},a.prototype.size=function(){var a;return a={windowWidth:$(window).width(),windowHeight:$(window).height(),documentWidth:$(document).width(),documentHeight:$(document).height(),bodyWidth:parseInt($("body").width()),bodyHeight:parseInt($("body").height()),mainWidth:parseInt($("body > main").width()),mainHeight:parseInt($("body > main").height()),headerWidth:parseInt($("body > main > header").width()),headerHeight:parseInt($("body > main > header").height()),footerWidth:parseInt($("body > main > footer").width()),footerHeight:parseInt($("body > main > footer").height()),sectionsWidth:parseInt($("body > main > .sections").width()),sectionsHeight:parseInt($("body > main > .sections").height())}},a.prototype.request=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;return null==a&&(a={}),a.url?(k=this,c=a.api||!1,m=a.url,l=a.type||"GET",g=a.dataType||!1,e=a.contentType||!1,f=a.data||{},h=a.headers||{},d=a.callback||!1,i=null!=(n=a.logs)?n:!0,$.support.cors=!0,b={url:m,type:l,data:f,headers:h,crossDomain:!0,cache:!1},g&&(b.dataType=g),e&&(b.contentType=e),j=$.ajax(b),j.done(function(b){var e;return i&&!c&&(e=$$.browser.msie?JSON.stringify(b):b,f=$$.browser.msie?JSON.stringify(f):f,console.debug("["+l+"] "+m+" | params:",f,"| success: ",e)),d?d(b,"success",!1,a):void 0}),void j.fail(function(b,e){var g;return i&&!c&&(g=$$.browser.msie?JSON.stringify(b):b,f=$$.browser.msie?JSON.stringify(f):f,console.error("["+l+"] "+m+" | params:",f,"| fail: ",g,e)),d?d(b,"fail",g,a):void 0})):console.error("[App > api] url not set!")},a.prototype.get=function(a,b,c){return null==b&&(b={}),this.request({url:a,type:"GET",data:b,callback:function(a){return c?c(a):void 0}})},a.prototype.post=function(a,b,c){return null==b&&(b={}),this.request({url:a,type:"POST",data:b,callback:function(a){return c?c(a):void 0}})},a.prototype.getJSON=function(a,b,c){return null==b&&(b={}),this.request({url:a,type:"GET",data:b,dataType:"json",callback:function(a){return c?c(a):void 0}})},a.prototype.api={setUrl:function(a){var b;return b=app.local?app.remoteHost:app.host,b+"/"+a},get:function(a,b,c){return null==b&&(b={}),app.request({api:!0,url:this.setUrl(a),type:"GET",data:b,dataType:"json",headers:{"X-CSRFToken":$.cookie("csrftoken")},callback:function(a){return function(b,d,e,f){return a.done(f,d,b,e,c)}}(this)})},post:function(a,b,c){return null==b&&(b={}),app.request({api:!0,url:this.setUrl(a),type:"POST",data:b,dataType:"json",headers:{"X-CSRFToken":$.cookie("csrftoken")},callback:function(a){return function(b,d,e,f){return a.done(f,d,b,e,c)}}(this)})},done:function(a,b,c,d,e){var f;if(!_.isObject(c))return void console.error("[API] response is not object!");if("fail"===b){if(400!==(f=c.status)&&404!==f||_.isEmpty(c.responseJSON))return console.error("["+a.type+"] API "+a.url+" | params:",a.data,"| fail",d),app.router.navigate("!ooops",!0);if(console.debug("["+a.type+"] API "+a.url+" | params:",a.data,"| error: ",c.responseJSON),e)return e(c.responseJSON)}else if(console.debug("["+a.type+"] API "+a.url+" | params:",a.data,"| success: ",c),e)return e(c)}},a.prototype.debugBox={logs:!1,state:!1,init:function(){return this.logs=app.boxMode&&__indexOf.call(app.boxParams,"logs")>=0,this.state=!0,$("body").append('<div id="debugBox" style="max-width: 400px;background:transparent;filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#60000000,endColorstr=#60000000);background: rgba(0,0,0,0.6);position:fixed;z-index:10000; right:5px; bottom:5px;color:white; padding: 10px;">\n	DebugBox - '+app.name+'\n	<pre class="browser">browser: <span>'+$$.browser.name+" ver."+$$.browser.version+'</span></pre>\n	<pre class="res">resolution: <span></span></pre>\n	<pre class="scroll">scroll: <span>none</span></pre>\n	<pre class="route">route: <span>none</span></pre>\n	<pre class="sect"></pre>\n	<pre class="mediaHeight" style="color:red;"></pre>\n	<pre class="mediaWidth" style="color:red;"></pre>\n	<div class="log" style="margin-top: 10px; max-height: 80px;overflow-y:auto;word-wrap: break-word;"><div></div></div>\n</div>')},style:function(){var a;return a=$("#debugBox"),a.find(".log").css({color:"#85FF00"}).scrollTop(a.find(".log div").height()),a.find("pre,span").css({font:"14px monospace",padding:0,margin:0})},log:function(a,b){switch(a){case"log":$("#debugBox .log div").append("<pre>"+b+"</pre>\n<pre>------</pre>");break;case"sect":$("#debugBox .sect").html("<pre>"+b+"</pre>");break;case"res":$("#debugBox .res span").html(""+b);break;case"scroll":$("#debugBox .scroll span").html(""+b);break;case"route":$("#debugBox .route span").html(""+b)}return this.style()}},a.prototype.libs=function(){},a.prototype.social={init:function(){return this.vkontakteApiId=app.local||/dev.site.ru/.test(app.host)?"4555300":"4574053",this.facebookApiId=app.local||/dev.site.ru/.test(app.host)?"1487802001472904":"687085858046891",this.odnoklassnikiApiId=""},auth:{vk:function(a){return"undefined"==typeof VK||null===VK?console.warn("[App > auth > vk] VK is not defined"):VK.Auth.login(function(b){return b.session?(console.debug("[VKONTAKTE > auth]",b.session.user),a(b.session.user)):console.error("[VKONTAKTE > auth]",b)})},fb:function(a){var b;return"undefined"==typeof FB||null===FB?console.warn("[App > auth > fb] FB is not defined"):(b=function(b){return FB.api("/me",function(c){return _.extend(c,b),console.debug("[FACEBOOK > auth]",c),a(c)})},FB.getLoginStatus(function(a){return"connected"===a.status?b(a.authResponse):FB.login(function(a){return a.authResponse?b(a.authResponse):console.error("[FACEBOOK > auth]",a)},{scope:"user_likes"})}))}},wallPost:{vk:function(a){return null==a&&(a={}),"undefined"==typeof VK||null===VK?console.warn("[App > social > wallPost] VK is not defined"):(a.attachLink=a.attachLink?""+app.social.url+"#"+a.attachLink:app.social.url,a.attachPhoto=a.attachPhoto?a.attachPhoto:"photo131380871_321439116",VK.api("wall.post",{owner_id:a.owner_id,message:a.message,attachments:""+a.attachPhoto+","+a.attachLink},function(b){return!b||b.error?(console.error("[VKONTAKTE > wall.post]",b),a.error&&a.error(b.error),popup&&b.error&&b.error.error_msg&&b.error.error_code&&214===b.error.error_code&&app.errors.popup("Стенка закрыта",!1)):(console.debug("[VKONTAKTE > wall.post] success"),a.success&&a.success()),a.allways?a.allways():void 0}))},fb:function(a){return null==a&&(a={}),"undefined"==typeof FB||null===FB?console.warn("[FB > social > wallPost] FB is not defined"):FB.ui({to:a.to,method:"feed",link:a.link||app.social.url,picture:a.picture||"",name:a.name||"",description:a.description||"",caption:a.caption||""},function(b){return b?(console.debug("[socWallPost Facebook] success"),a.success&&a.success()):(console.error("[socWallPost Facebook] error",b),a.error&&a.error()),a.allways?a.allways():void 0})},ok:function(a){var b;return null==a&&(a={}),b=a.url||app.social.url,window.open("http://www.odnoklassniki.ru/dk?st.cmd=addShare&st.s=1&st._surl="+encodeURIComponent(b)+"&st.comments="+encodeURIComponent(a.comments),"","toolbar=0,status=0,width=626,height=436")}},share:{it:function(){var a;return a={},a.title="title",a.description="description",a.image=""+app.host+"/img/for_post.png",this.facebook(a)},vk:function(a){var b;return null==a&&(a={}),a.url||(a.url=app.local?app.remoteHost+window.location.pathname+window.location.hash:window.location.href),b="http://vkontakte.ru/share.php?",a.url&&(b+="url="+encodeURIComponent(a.url)),a.title&&(b+="&title="+encodeURIComponent(a.title.substr(0,100))),a.description&&(b+="&description="+encodeURIComponent(a.description.substr(0,100)+"...")),a.image&&(b+="&image="+encodeURIComponent(a.image)),b+="&noparse=true",this.popup(b)},vkCount:function(a){return null==a&&(a={}),a.url||(a.url=app.local?app.remoteHost+window.location.pathname+window.location.hash:window.location.href),window.VK.share||(window.VK.Share={}),window.VK.Share.count=function(b,c){return console.debug("[VK Share count]",c),a.callback?a.callback(c):void 0},$.getJSON("http://vkontakte.ru/share.php?act=count&index=1&url="+escape(a.url)+"&format=json&callback=?")},ok:function(a){var b;return null==a&&(a={}),a.url||(a.url=app.local?app.remoteHost+window.location.pathname+window.location.hash:window.location.href),b="http://www.odnoklassniki.ru/dk?st.cmd=addShare&st.s=1",a.url&&(b+="&st._surl="+encodeURIComponent(a.url)),a.title&&(b+="&title="+encodeURIComponent(a.title)),a.description&&(b+="&st.comments="+encodeURIComponent(a.description)),this.popup(b)},okCount:function(a){return null==a&&(a={}),a.url||(a.url=app.local?app.remoteHost+window.location.pathname+window.location.hash:window.location.href),window.ODKL||(window.ODKL={}),window.ODKL.updateCountOC=function(b,c){return console.debug("[OK Share count]",c),a.callback?a.callback(c):void 0},$.getJSON("http://www.odnoklassniki.ru/dk?st.cmd=extOneClickLike&uid=odklocs0&callback=?&ref="+escape(a.url))},fb:function(a){return null==a&&(a={}),a.url||(a.url=app.local?app.remoteHost+window.location.pathname+window.location.hash:window.location.href),FB.ui({method:"feed",link:a.url,name:a.title?a.title.substr(0,100):void 0,caption:a.description?a.description.substr(0,100)+"...":void 0,picture:a.image?a.image:void 0},function(){})},fbCount:function(a){return null==a&&(a={}),a.url||(a.url=app.local?app.remoteHost+window.location.pathname+window.location.hash:window.location.href),$.getJSON("http://api.facebook.com/restserver.php?method=links.getStats&callback=?&urls="+escape(a.url)+"&format=json",function(b){return console.debug("[FB Share count]",b[0].share_count),a.callback?a.callback(b[0].share_count):void 0})},tw:function(a){var b;return null==a&&(a={}),a.url||(a.url=app.local?app.remoteHost+window.location.pathname+window.location.hash:window.location.href),b="http://twitter.com/share?",a.title&&(b+="text="+encodeURIComponent(a.title)),a.url&&(b+="&url="+encodeURIComponent(a.url)),a.url&&(b+="&counturl="+encodeURIComponent(a.url)),this.popup(b)},twCount:function(a){return null==a&&(a={}),a.url||(a.url=app.local?app.remoteHost+window.location.pathname+window.location.hash:window.location.href),$.getJSON("http://urls.api.twitter.com/1/urls/count.json?url="+escape(a.url)+"&callback=?",function(b){return console.debug("[TW Share count]",b.count),a.callback?a.callback(b.count):void 0})},mailru:function(a){var b;return null==a&&(a={}),a.url=a.url||app.social.url,b="http://connect.mail.ru/share?",b+="url="+encodeURIComponent(a.url),b+="&title="+encodeURIComponent(a.title),b+="&description="+encodeURIComponent(a.description),b+="&imageurl="+encodeURIComponent(a.image),this.popup(b)},popup:function(a){return window.open(a,"","toolbar=0,status=0,width=626,height=436")}}},a.prototype.errors={popup:function(a,b){var c;return null==b&&(b=!0),c=b?this.get(a):a,popup.custom("Ошибка!",c)},get:function(a){var b;return $$.isObject(a)?(b="",_.each(a,function(a){return function(c){return c=a.rus[c]||c,b+=c+"<br/><br/>"}}(this))):b=this.rus[a],b||"Неизвестная ошибка"},rus:{"Story doesn't exist":"Истории не существует","User is not authenticated":"Юзер не авторизован"}},a}();